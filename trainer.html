<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>English trainer</title>
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
</head>
<style>
	.starter-template {
  padding: 40px 15px;
  text-align: center
;}
</style>
<script src="./javascripts/jquery-2.1.1.min.js"></script>
<script src="./javascripts/menu.js"></script>
<script src="./bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script type="text/javascript" charset="utf-8">
	var words;
	var currentWord;
	var isForeign;
	var isShowPronunciation;
	function setNewWord(){
		var index = Math.floor(Math.random() * words.length - 1);
		if (index < 0){ return; }
		currentWord = words[index];
		isForeign = true;
		showCurrent();
	}
	function showCurrent(){
		if (currentWord == undefined){
			return;
		}

		var text;
		if (isForeign){
			text = isShowPronunciation ? currentWord.foreign + " " + currentWord.pronunciation : currentWord.foreign;
		}
		else {	
			text = currentWord.motherTongue;
		}
		$('#divWord').text(text);
	}
	function switchText(){
		isForeign = !isForeign;
		showCurrent();
	}
	function downloadWords(fileName){
		var client = new XMLHttpRequest();
		client.open('GET', '/' + fileName + ".txt");
		client.onreadystatechange = function() { 
			words = client.responseText
			.split('\n')
			.map(function(el){
				var word = el.split('\t');
				return {
					foreign: word[0],
					pronunciation: word[1],
					motherTongue: word[2]
				};
			}); 
			$("#file").text($("#" + fileName).text());
			setNewWord();
			showCurrent();
		};
		client.send();
	}
	function showPronunciation(show){
		isShowPronunciation = show;
		var text;
		if (show){
			text = $("#showPron").text();
		}
		else {
			text = $("#dontShowPron").text();
		}
		$("#pronOptions").text(text);
		if (currentWord != undefined){
			showCurrent();	
		}
	}
</script>
<script>
	$(document).ready(function(){
		createMenu("trainer.html");
		showPronunciation(false);
		$("#easyWords").trigger("click");
		$("#easy").trigger('click');
	});
</script>
<body>
	<div class="container">	
		<div class="starter-template">
	        <h2>My personal English trainer</h2>
    	</div>

    	<div class="collapse navbar-collapse" style="text-align: center;">
			<ul class="nav navbar-nav">
				<li class="dropdown">
				  <a href="#" id="file" class="btn btn-default" data-toggle="dropdown">Options</a>
				  <ul class="dropdown-menu" role="menu">
				    <li><a id="easy" href="#" class="btn btn-default" onclick="downloadWords('easy')">Easy words</a></li>
				    <li><a id="medium" href="#" class="btn btn-default" onclick="downloadWords('medium')">Normal words</a></li>
				    <li><a id="more" href="#" class="btn btn-default" onclick="downloadWords('more')">More words</a></li>
				  </ul>
				</li>

				<li class="dropdown">
				  <a href="#" id="pronOptions" class="btn btn-default" data-toggle="dropdown">Options</a>
				  <ul class="dropdown-menu" role="menu">
				    <li><a id="showPron" href="#" onclick="showPronunciation(true)">Show pronunciation</a></li>
				    <li><a id="dontShowPron" href="#" onclick="showPronunciation(false)">Don't show pronunciation</a></li>
				  </ul>
				</li>
			</ul>
    	</div><!-- /.navbar-collapse -->

	    <div class="starter-template">
			<Button id="newButton" class="btn btn-lg btn-success" onclick="setNewWord()">know word</Button>
			<Button id="dontKnowButton" class="btn btn-lg btn-warning" onclick="switchText()">don't know word</Button>
		  	<div style="padding: 10px;font-size: 18pt" id="divWord"/>
    	</div>
    </div>
</body>
</html>