{"pageProps":{"title":"Postgres","content":"### Show which queries use the most resources\n```sql\nselect total_exec_time,\n\t     mean_exec_time as avg_ms,\n\t     calls,\n\t     query\nfrom pg_stat_statements\norder by mean_exec_time desc\nlimit 10;\n```\n\n### Show table sizes\n```sql\nselect relname as relation,\n       pg_size_pretty (\n         pg_total_relation_size (c .oid)\n       ) as total_size\nfrom pg_class c\nleft join pg_namespace n ON (n.oid = c.relnamespace)\nwhere nspname not in (\n        'pg_catalog',\n        'information_schema'\n      )\n  and c.relkind <> 'i'\n  and nspname !~ '^pg_toast'\n  order by pg_total_relation_size (c.oid) desc\n```\n\n### Select for update\nMay be useful when we need to implement concurrent updates.\n```sql\nselect *\nfrom table_name\nwhere condition\nfor update;\n```\n\n### Select for update skip locked\nMay be useful when we need to implement concurrent updates but we don't want to wait.\n\n```sql\nselect *\nfrom table_name\nwhere condition\nfor update\nskip locked;\n```\n\n### Standby mode\n- Hot standby: a replica accepts requests from clients.\n- Warm standby: a replica does NOT accept requests from clients.\n"},"__N_SSG":true}